<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>아이템 관리</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    <style>
        /* Tailwind CSS 메인 컬러 설정 (자료실 페이지 기준) */
        :root {
          --color-dark-navy: #2F4160;
          --color-coral-pink: #F29DA0;
          --color-soft-sky: #B5D0E3;
        }
        .bg-dark-navy { background-color: var(--color-dark-navy); }
        .text-dark-navy { color: var(--color-dark-navy); }
        .bg-coral-pink { background-color: var(--color-coral-pink); }
        .text-coral-pink { color: var(--color-coral-pink); }
        .bg-soft-sky { background-color: var(--color-soft-sky); }
        .text-soft-sky { color: var(--color-soft-sky); }

        /* 모든 페이지네이션 링크를 위한 기본 스타일 */
        .pagination-item-base {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.375rem 0.75rem;
            background-color: transparent;
            color: #2F4160;
            border: 1px solid transparent;
            border-radius: 0.375rem;
            text-decoration: none;
            font-weight: 600;
            min-width: 36px;
            height: 36px;
            box-sizing: border-box;
            transition-property: background-color, color, border-color;
            transition-duration: 200ms;
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* 모든 페이지네이션 링크의 호버 상태 */
        .pagination-item-base:hover {
            background-color: #e0e0e0;
            color: #2F4160;
            border-color: #e0e0e0;
        }

        /* 활성 페이지 번호 스타일 */
        .pagination-item-base.active {
            font-weight: bold;
            background-color: #4B4B4B;
            color: white;
            border-color: #4B4B4B;
        }

        /* 활성 페이지 버튼의 호버 효과 */
        .pagination-item-base.active:hover {
            background-color: #4B4B4B;
            color: white;
            border-color: #4B4B4B;
        }

        /* 비활성화된 버튼 스타일 */
        .pagination-item-base.disabled {
            opacity: 0.5;
            cursor: default !important;
            background-color: transparent;
            color: #2F4160;
            border-color: transparent;
        }

        /* 비활성화된 버튼의 호버 효과 */
        .pagination-item-base.disabled:hover {
            background-color: transparent;
            color: #2F4160;
            border-color: transparent;
        }
    </style>
</head>
<body class="bg-[#f3f4f6] min-h-screen flex flex-col text-[#2F4160]">

<div th:replace="~{fragments/header :: headerFragment}"></div>

<div class="flex-grow flex justify-center w-full">
    <main class="bg-white rounded-xl shadow-xl w-full max-w-7xl mx-auto flex-grow p-8 box-border">

        <div class="flex justify-between items-center mb-6">
            <h2 class="text-3xl font-bold text-[#2F4160]">아이템 관리</h2>
            <div class="flex flex-col items-end space-y-2">
                <div sec:authorize="hasRole('ADMIN')">
                    <a th:href="@{/admin}"
                       class="inline-block bg-[#2F4160] text-white py-2 px-4 rounded-lg shadow-md hover:bg-[#4B4B4B] transition-colors duration-200">
                        관리자 페이지<i class="fas fa-arrow-right ml-2"></i>
                    </a>
                </div>
                <a href="/item/chuga"
                   class="bg-[#4B4B4B] text-white font-semibold py-2 px-6 rounded-lg hover:bg-[#2F4160] transition duration-300 shadow-md flex items-center">
                    <i class="fas fa-plus mr-2"></i>
                    아이템 추가
                </a>
            </div>
        </div>

        <div th:if="${message}" class="p-4 text-center text-green-700 bg-[#B5D0E3] rounded-b-xl">
            [[${message}]]
        </div>

        <div class="p-8 overflow-x-auto">
            <table class="min-w-full bg-white border-collapse">
                <thead>
                <tr class="bg-gray-200 border-b border-[#E0E0E0]">
                    <th class="py-3 px-6 text-center text-sm font-semibold text-[#2F4160] uppercase tracking-wider">ID</th>
                    <th class="py-3 px-6 text-center text-sm font-semibold text-[#2F4160] uppercase tracking-wider w-1/6">이름</th>
                    <th class="py-3 px-6 text-center text-sm font-semibold text-[#2F4160] uppercase tracking-wider w-1/12">가격</th>
                    <th class="py-3 px-6 text-center text-sm font-semibold text-[#2F4160] uppercase tracking-wider">설명</th>
                    <th class="py-3 px-6 text-center text-sm font-semibold text-[#2F4160] uppercase tracking-wider w-1/6">관리</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="item : ${itemPage.content}" class="border-b border-gray-200 hover:bg-gray-50">
                    <td class="py-4 px-6 text-sm text-gray-800 text-center" th:text="${item.itemId}"></td>
                    <td class="py-4 px-6 text-sm text-gray-800 w-1/6 text-center" th:text="${item.itemName}"></td>
                    <td class="py-4 px-6 text-sm text-gray-800 w-1/12 text-center" th:text="${item.price}"></td>
                    <td class="py-4 px-6 text-sm text-gray-800" th:text="${item.itemDescription}"></td>
                    <td class="py-4 px-6 text-sm font-medium text-center">
                        <div class="flex justify-center items-center space-x-2">
                            <a th:href="@{'/item/sujung/' + ${item.itemId}}"
                               class="inline-flex items-center space-x-1 bg-[#4B4B4B] text-white font-semibold py-1 px-3 rounded-lg hover:bg-[#2F4160] transition duration-300 whitespace-nowrap">
                                <i class="fas fa-edit"></i> <span>수정</span>
                            </a>
                            <button type="button"
                                    class="inline-flex items-center space-x-1 bg-red-500 text-white font-semibold py-1 px-3 rounded-lg hover:bg-red-600 transition duration-300 whitespace-nowrap"
                                    th:onclick="'confirmDelete(' + ${item.itemId} + ');'">
                                <i class="fas fa-trash"></i> <span>삭제</span>
                            </button>
                        </div>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <div id="pagination-controls" class="flex justify-center items-center mt-6 space-x-2" th:if="${itemPage.totalPages > 1}">
            <a th:href="@{|/item/admin?page=0|}"
               th:classappend="${itemPage.number == 0} ? 'disabled'"
               class="pagination-item-base">처음</a>

            <a th:href="@{|/item/admin?page=${itemPage.number - 1}|}"
               th:classappend="${!itemPage.hasPrevious()} ? 'disabled'"
               class="pagination-item-base">이전</a>

            <span th:each="i : ${#numbers.sequence(startPage, endPage)}">
                <a th:href="@{|/item/admin?page=${i}|}"
                   th:text="${i + 1}"
                   th:classappend="${i == itemPage.number} ? 'active'"
                   class="pagination-item-base">1</a>
            </span>

            <a th:href="@{|/item/admin?page=${itemPage.number + 1}|}"
               th:classappend="${!itemPage.hasNext()} ? 'disabled'"
               class="pagination-item-base">다음</a>

            <a th:href="@{|/item/admin?page=${itemPage.totalPages - 1}|}"
               th:classappend="${itemPage.number == itemPage.totalPages - 1} ? 'disabled'"
               class="pagination-item-base">마지막</a>
        </div>
    </main>
</div>

<div th:replace="~{fragments/footer :: footerFragment}"></div>

<script>
    function confirmDelete(itemId) {
        if (confirm('정말 이 아이템을 삭제하시겠습니까?')) {
            window.location.href = '/item/delete/' + itemId;
        }
    }
</script>

</body>
</html>