<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HanTalk - 문장 목록</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />

    <style>
        .text-shadow-custom {
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        .pagination a, .pagination span {
            display: flex;
            justify-content: center;
            align-items: center;
            /* 페이지 번호 버튼의 너비와 높이를 고정 */
            width: 40px;
            height: 40px;
            border-radius: 9999px;
            transition-property: background-color, border-color, color, fill, stroke, opacity, box-shadow, transform;
            transition-duration: 150ms;
        }

        /* 텍스트가 있는 페이지네이션 링크를 위한 스타일 (예: 처음, 이전, 다음, 마지막) */
        .pagination .text-link {
            width: auto; /* 너비를 자동으로 설정 */
            min-width: 80px; /* 최소 너비를 보장하여 텍스트가 좁아지지 않도록 함 */
            padding: 0 16px; /* 좌우 패딩을 추가 */
        }

        .pagination .active a {
            background-color: #F29DA0; /* 코랄 핑크 */
            color: #ffffff; /* 흰색 */
            pointer-events: none;
        }
        .pagination .disabled {
            opacity: 0.5;
            cursor: default;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col bg-gray-100">

<div th:replace="~{fragments/header :: headerFragment}"></div>

<main class="flex-grow p-8 container mx-auto">
    <!-- 제목만 중앙에 위치 -->
    <h1 class="text-4xl font-extrabold text-center mb-10" style="color: #2F4160; text-shadow: 1px 1px 2px rgba(0,0,0,0.1);">문장 목록</h1>

    <!-- 검색창, 검색 버튼, 학습 메인 버튼을 포함하는 컨테이너 -->
    <div class="flex items-center justify-end w-full mb-10 gap-4">
        <!-- 검색 입력창과 검색 버튼을 묶는 form -->
        <form th:action="@{/study/sentenceList}" method="get"
              class="flex items-center gap-2" style="max-width: 750px;">
            <!-- 검색 입력창 -->
            <input type="text" name="kw" th:value="${kw}" placeholder="문장 또는 의미 검색"
                   class="flex-grow p-3 border rounded-lg focus:outline-none focus:ring-2"
                   style="border-color: #2F4160; background-color: #F8F9FA; color: #2F4160; focus:ring-color: #F29DA0;">
            <!-- 검색 버튼: 핑크 배경 → 호버 시 네이비 -->
            <button type="submit"
                    class="bg-[#B5D0E3] hover:bg-[#8DAAC1] text-white py-2 px-4 rounded-lg font-semibold transition duration-300">
                검색
            </button>
        </form>
        <!-- 학습 메인 버튼 -->
        <a th:href="@{/study/main}"
           class="inline-block px-4 py-2 rounded-lg shadow-md transition-colors duration-300
                text-white font-semibold bg-[#F29DA0] hover:bg-[#B5D0E3] whitespace-nowrap">
            학습 메인으로 이동
        </a>
    </div>

    <div class="rounded-lg shadow-md overflow-hidden" style="background-color: #F8F9FA;">
        <table class="min-w-full divide-y" style="border-color: #B5D0E3;">
            <thead class="text-white" style="background-color: #2F4160;">
            <tr>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">
                    순번
                </th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">
                    문장
                </th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">
                    의미
                </th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">
                    등록일
                </th>
            </tr>
            </thead>
            <tbody class="divide-y" style="border-color: #B5D0E3;">
            <tr th:if="${paging.content == null || paging.content.isEmpty()}">
                <td colspan="4" class="px-6 py-4 whitespace-nowrap text-center text-sm font-medium" style="color: #2F4160;">
                    문장 데이터가 존재하지 않습니다.
                </td>
            </tr>
            <tr th:each="sentence, loop : ${paging.content}" th:if="${sentence != null}" th:classappend="${loop.count % 2 == 0} ? 'bg-gray-100' : ''" style="color: #2F4160;">
                <td th:text="${paging.number * paging.size + loop.count}" class="px-6 py-4 whitespace-nowrap text-sm"></td>
                <td th:text="${sentence.munjang?.replace('^',' ')}" class="px-6 py-4 text-sm"></td>
                <td th:text="${sentence.description}" class="px-6 py-4 text-sm"></td>
                <td th:text="${#temporals.format(sentence.createDate, 'yyyy-MM-dd')}" class="px-6 py-4 whitespace-nowrap text-sm"></td>
            </tr>
            </tbody>
        </table>
    </div>

    <!-- 페이지네이션 수정 -->
    <div th:if="${!paging.isEmpty()}" class="flex justify-center mt-8">
        <div th:with="startPage=${paging.number / 10 * 10}, endPage=${T(java.lang.Math).min(paging.totalPages - 1, paging.number / 10 * 10 + 9)}">
            <ul class="flex gap-2 pagination">
                <li th:classappend="${!paging.hasPrevious} ? 'disabled'">
                    <a th:href="@{|?page=0&kw=${kw}|}"
                       class="border text-white hover:bg-opacity-80 text-link"
                       style="background-color: #2F4160; border-color: #2F4160;">
                        처음
                    </a>
                </li>
                <li th:classappend="${!paging.hasPrevious} ? 'disabled'">
                    <a th:href="${paging.hasPrevious} ? @{|?page=${paging.number-1}&kw=${kw}|} : '#'"
                       class="border text-white hover:bg-opacity-80 text-link"
                       style="background-color: #2F4160; border-color: #2F4160;">
                        이전
                    </a>
                </li>
                <li th:each="page: ${#numbers.sequence(startPage, endPage)}"
                    th:classappend="${page == paging.number} ? 'active'">
                    <a th:href="@{|?page=${page}&kw=${kw}|}"
                       th:text="${page + 1}"
                       class="border"
                       style="border-color: #2F4160; color: #2F4160;">
                    </a>
                </li>
                <li th:classappend="${!paging.hasNext} ? 'disabled'">
                    <a th:href="${paging.hasNext} ? @{|?page=${paging.number+1}&kw=${kw}|} : '#'"
                       class="border text-white hover:bg-opacity80 text-link"
                       style="background-color: #2F4160; border-color: #2F4160;">
                        다음
                    </a>
                </li>
                <li th:classappend="${!paging.hasNext} ? 'disabled'">
                    <a th:href="@{|?page=${paging.totalPages-1}&kw=${kw}|}"
                       class="border text-white hover:bg-opacity80 text-link"
                       style="background-color: #2F4160; border-color: #2F4160;">
                        마지막
                    </a>
                </li>
            </ul>
        </div>
    </div>

</main>

<div th:replace="~{fragments/footer :: footerFragment}"></div>

</body>
</html>
