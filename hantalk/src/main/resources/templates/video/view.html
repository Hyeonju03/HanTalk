<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title th:text="${video.title} + ' | 강의 상세 보기'"></title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body {
        background-color: #f9fafb;
        color: #4A5568;
    }

    .card {
        background-color: #ffffff;
        border-color: #E5E7EB;
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.1);
    }

    .action-button {
        transition: all 0.2s ease-in-out;
    }

    .action-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }

    .play-button-container {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        display: flex;
        justify-content: center;
        align-items: center;
        width: 100px;
        height: 100px;
        background-color: rgba(0, 0, 0, 0.7);
        border-radius: 50%;
        z-index: 10;
        cursor: pointer;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
        transition: transform 0.3s ease, background-color 0.3s ease;
    }

    .play-btn {
        width: 0;
        height: 0;
        border-top: 20px solid transparent;
        border-left: 35px solid white;
        border-bottom: 20px solid transparent;
        transform: translateX(3px);
    }

    .play-button-container:hover {
        background-color: rgba(0, 0, 0, 0.9);
        transform: translate(-50%, -50%) scale(1.1);
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .animate-fadeIn {
        animation: fadeIn 0.8s ease-out forwards;
    }

    .copy-success {
        position: absolute;
        top: -30px;
        left: 50%;
        transform: translateX(-50%);
        background-color: #2F4160;
        color: white;
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 0.75rem;
        opacity: 0;
        transition: opacity 0.5s ease-out;
        white-space: nowrap;
        pointer-events: none;
    }

    .copy-success.show {
        opacity: 1;
    }
  </style>
</head>
<body class="font-sans flex flex-col min-h-screen">

<div th:replace="~{fragments/header :: headerFragment}"></div>

<main class="flex-1 px-4 py-10">
  <div class="card rounded-3xl shadow-2xl p-8 md:p-12 border max-w-screen-xl mx-auto animate-fadeIn">
    <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between mb-8">
      <div class="sm:w-3/4 sm:pr-4">
        <h1 class="text-3xl md:text-4xl font-extrabold mb-2 leading-tight break-words text-[#2F4160]">
          <span th:text="${video.title}">제목</span>
        </h1>
        <div class="flex flex-wrap items-center text-sm md:text-sm text-[#4A5568]">
          <div class="flex items-center">
            <i class="fas fa-calendar-alt mr-1 text-[#B5D0E3]"></i>
            <span>등록일</span>
            <span th:text="${#temporals.format(video.createDate, 'yyyy-MM-dd')}" class="ml-1"></span>
          </div>
          <div th:if="${video.updateDate != null}" class="flex items-center">
            <span class="text-xl px-3 font-light text-[#E5E7EB]">|</span>
          </div>
          <div th:if="${video.updateDate != null}" class="flex items-center">
            <i class="fas fa-edit mr-1 text-[#B5D0E3]"></i>
            <span>수정일</span>
            <span th:text="${#temporals.format(video.updateDate, 'yyyy-MM-dd')}" class="ml-1"></span>
          </div>
          <div class="flex items-center">
            <span class="text-xl px-3 font-light text-[#E5E7EB]">|</span>
          </div>
          <div class="flex items-center">
            <i class="fas fa-eye mr-1 text-[#B5D0E3]"></i>
            <span>조회수</span>
            <span th:text="${video.viewHit != null ? video.viewHit : 0}" class="ml-1"></span>
          </div>
        </div>
      </div>
      <div class="mt-4 sm:mt-0 flex flex-wrap gap-2 flex-shrink-0">
        <a id="copyLinkBtn" class="action-button inline-flex items-center justify-center px-4 py-2 text-[#2F4160] font-semibold rounded-full shadow-md transition duration-300 relative bg-[#f3f4f6]">
          <i class="fas fa-link mr-2"></i> 링크 복사
          <span id="copySuccessMsg" class="copy-success">복사됨!</span>
        </a>
        <a th:if="${isAdmin}" th:href="@{/video/admin/sujung/{id}(id=${video.videoId})}" class="action-button inline-flex items-center justify-center px-4 py-2 text-white font-semibold rounded-full shadow-md transition duration-300 relative bg-[#2F4160]">
          <span class="mr-2">✏️</span> 영상 수정
        </a>
        <a th:if="${isAdmin}" th:href="@{/video/admin/list}" class="action-button inline-flex items-center justify-center px-4 py-2 text-white font-semibold rounded-full shadow-md transition duration-300 relative bg-[#2F4160]">
          <i class="fas fa-bars mr-2"></i> 관리자페이지
        </a>
        <a th:unless="${isAdmin}" th:href="@{/video/list}" class="action-button inline-flex items-center justify-center px-4 py-2 text-white font-semibold rounded-full shadow-md transition duration-300 relative bg-[#2F4160]">
          <i class="fas fa-bars mr-2"></i> 목록으로
        </a>
      </div>
    </div>
    <div id="videoContainer" class="relative w-full mb-8 rounded-2xl overflow-hidden shadow-2xl flex items-center justify-center" style="aspect-ratio: 16 / 9;">
      <video id="videoPlayer" width="100%" height="100%" controls class="w-full h-full object-cover">
        <source th:src="@{'/videos/' + ${video.videoName}}" type="video/mp4">
        이 브라우저는 video 태그를 지원하지 않습니다.
      </video>
      <div id="playButtonOverlay" class="play-button-container">
        <div class="play-btn"></div>
      </div>
    </div>
    <div class="border-t pt-6 pl-4 border-[#E5E7EB]">
      <h2 class="text-xl md:text-2xl font-bold mb-3 text-[#2F4160]">영상 설명</h2>
      <p class="leading-relaxed whitespace-pre-wrap text-[#4A5568]" th:text="${video.content}">설명</p>
    </div>
  </div>
</main>

<div th:replace="~{fragments/footer :: footerFragment}"></div>

<script>
  const videoPlayer = document.getElementById('videoPlayer');
  const playButtonOverlay = document.getElementById('playButtonOverlay');
  const copyLinkBtn = document.getElementById('copyLinkBtn');
  const copySuccessMsg = document.getElementById('copySuccessMsg');


  playButtonOverlay.addEventListener('click', () => {
      videoPlayer.play();
      playButtonOverlay.remove();
  });

  copyLinkBtn.addEventListener('click', (e) => {
      e.preventDefault();
      const url = window.location.href;
      const tempInput = document.createElement('input');
      tempInput.value = url;
      document.body.appendChild(tempInput);
      tempInput.select();
      document.execCommand('copy');
      document.body.removeChild(tempInput);
      showCopySuccess();
  });

  function showCopySuccess() {
      copySuccessMsg.classList.add('show');
      setTimeout(() => {
          copySuccessMsg.classList.remove('show');
      }, 1500);
  }
</script>
</body>
</html>
