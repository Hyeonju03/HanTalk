
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>ê°•ì˜ ëª©ë¡</title>
  <style>
    body {
        font-family: Arial, sans-serif;
        padding: 30px;
        background-color: #f4f4f4;
    }
    h1 { color: #333; }

    /* ì‚¬ìš©ì ì¹´ë“œ ìŠ¤íƒ€ì¼ */
    .video-card {
        background: white;
        padding: 15px;
        margin-bottom: 15px;
        border: 1px solid #ddd;
    }
    .video-actions {
        margin-top: 10px;
    }
    .video-actions a, .video-actions button {
        margin-right: 8px;
        text-decoration: none;
        color: #007BFF;
        border: none;
        background: none;
        cursor: pointer;
    }

    /* í˜ì´ì§• ìŠ¤íƒ€ì¼ */
    .pagination {
        margin-top: 20px;
    }
    .pagination a {
        margin: 0 5px;
        text-decoration: none;
    }
    .active-page {
        font-weight: bold;
        color: red;
    }

    /* âœ… ì˜ìƒ ì¸ë„¤ì¼ í˜•íƒœ */
.thumbnail-link {
    position: relative;
    display: block;
    width: 200px;
    height: 112px;
    overflow: hidden;
    border-radius: 5px;
    margin-top: 10px;
}

.video-thumbnail {
    width: 100%;
    height: 100%;
    object-fit: cover;
    pointer-events: none; /* ì˜ìƒ í´ë¦­ ë°©ì§€ (aíƒœê·¸ë§Œ ì‘ë™) */
}

/* âœ… ì¤‘ì•™ â–¶ ì•„ì´ì½˜ ì˜¤ë²„ë ˆì´ */
.play-icon-overlay {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 36px;
    color: white;
    text-shadow: 0 0 10px black;
    pointer-events: none;
}
  </style>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
<h1>ğŸ¬ ì˜ìƒ ëª©ë¡</h1>
<!-- âš ï¸ ë¡œê·¸ì¸ í•„ìš” ë©”ì‹œì§€ í‘œì‹œ -->
<div th:if="${msg}" style="color:red; margin-top:10px;">
  <strong th:text="${msg}"></strong>
</div>

<!--
 ê´€ë¦¬ìì¼ ë•Œë§Œ ë³´ì´ëŠ” ë²„íŠ¼
<div th:if="${isAdmin}">
  <a th:href="@{/video/admin/list}">ê´€ë¦¬ì í˜ì´ì§€ë¡œ ì´ë™</a>
</div>
-->

<!-- ê²€ìƒ‰ -->
<form method="get" th:action="@{/video/user/contentList}">
  <input type="text" name="keyword" th:value="${keyword}" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥" />
  <select name="searchType">
    <option value="title" th:selected="${searchType == 'title'}">ì œëª©</option>
    <option value="content" th:selected="${searchType == 'content'}">ë‚´ìš©</option>
    <option value="all" th:selected="${searchType == 'all'}">ì œëª© + ë‚´ìš©</option>
  </select>
  <button type="submit">ê²€ìƒ‰</button>
</form>
<!--
&lt;!&ndash; ğŸ¯ ì˜ìƒ ë“±ë¡ ë²„íŠ¼ (ê´€ë¦¬ìë§Œ) &ndash;&gt;
<a th:if="${isAdmin}" th:href="@{/admin/video/upload}">â• ìƒˆ ì˜ìƒ ë“±ë¡</a>

&lt;!&ndash; âœ… 1. ê´€ë¦¬ì í™”ë©´ (í…Œì´ë¸” í˜•ì‹) &ndash;&gt;
<table th:if="${isAdmin}">
  <thead>
  <tr>
    <th>ë²ˆí˜¸</th>
    <th>ì œëª©</th>
    <th>ì„¤ëª…</th>
    <th>ë“±ë¡ì¼</th>
    <th>ìˆ˜ì •ì¼</th>
    <th>ê´€ë¦¬</th>
  </tr>
  </thead>
  <tbody>
  <tr th:each="video, stat : ${videoPage.content}" th:id="'row-' + ${video.videoId}">
    <td th:text="${videoPage.number * videoPage.size + stat.index + 1}">1</td>
    <td>
      &lt;!&ndash; ë””ë²„ê¹…: ID í™•ì¸ &ndash;&gt;
      <span th:text="'[ID: ' + ${video.videoId} + ']'">[ID]</span>

      &lt;!&ndash; ì œëª© ë§í¬ &ndash;&gt;
      <a th:href="@{/admin/video/view/{id}(id=${video.videoId})}" th:text="${video.title}">ì œëª©</a>
    </td>
    <td th:text="${video.content}">ë‚´ìš©</td>
    <td th:text="${#temporals.format(video.createDate, 'yyyy-MM-dd')}">ë“±ë¡ì¼</td>
    <td th:text="${video.updateDate != null ? #temporals.format(video.updateDate, 'yyyy-MM-dd') : ''}"></td>
    <td>
      <a th:href="@{/admin/video/edit/{id}(id=${video.videoId})}">ìˆ˜ì •</a> |
      <button type="button" th:attr="data-id=${video.videoId}" onclick="deleteVideo(this)">ì‚­ì œ</button>
    </td>
  </tr>
  </tbody>
</table>-->

<!-- âœ… 2. ì‚¬ìš©ì í™”ë©´ (ì¹´ë“œí˜• ëª©ë¡) -->
<!--<div th:if="${!isAdmin}">-->
  <div th:each="video, stat : ${videoPage.content}" class="video-card">
    <div>
      <strong th:text="(${videoPage.number} * ${videoPage.size} + ${stat.index} + 1) + '. '">1.</strong>

      <a th:href="@{/video/user/contentView/{id}(id=${video.videoId})}" th:text="${video.title}">ì˜ìƒ ì œëª©</a>
    </div>

    <a th:href="@{/video/user/contentView/{id}(id=${video.videoId})}" class="thumbnail-link">
      <video class="video-thumbnail" muted playsinline preload="metadata">
        <source th:src="@{'/videos/' + ${video.videoName}}" type="video/mp4" />
        ì˜ìƒ íƒœê·¸ë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¸Œë¼ìš°ì €ì…ë‹ˆë‹¤.
      </video>
      <div class="play-icon-overlay">â–¶</div>
    </a>

    <p th:text="${video.content}">ì„¤ëª…</p>
  </div>
<!--</div>-->
<!--
  3. í˜ì´ì§•
<div class="pagination" th:if="${videoPage.totalPages > 1}">
  <span th:each="i : ${#numbers.sequence(0, videoPage.totalPages - 1)}">
 <a th:href="@{/video/user/contentList(page=${i}, keyword=${keyword}, searchType=${searchType})}"
    th:class="${i == videoPage.number} ? 'active-page' : ''"
    th:text="${i + 1}">1</a>
</span>
</div>-->

<div class="pagination" th:if="${videoPage.totalPages > 1}">
  <!-- ì´ì „ ë²„íŠ¼ -->
  <a th:if="${!videoPage.first}"
     th:href="@{/video/user/contentList(page=${videoPage.number - 1}, keyword=${keyword}, searchType=${searchType})}">
    &laquo; ì´ì „
  </a>
  <span th:if="${videoPage.first}" style="color: #ccc;">&laquo; ì´ì „</span>

  <!-- í˜ì´ì§€ ë²ˆí˜¸ ë²„íŠ¼ -->
  <span th:each="i : ${#numbers.sequence(0, videoPage.totalPages - 1)}">
    <a th:href="@{/video/user/contentList(page=${i}, keyword=${keyword}, searchType=${searchType})}"
       th:classappend="${i == videoPage.number} ? ' active-page' : ''"
       th:text="${i + 1}">1</a>
  </span>

  <!-- ë‹¤ìŒ ë²„íŠ¼ -->
  <a th:if="${!videoPage.last}"
     th:href="@{/video/user/contentList(page=${videoPage.number + 1}, keyword=${keyword}, searchType=${searchType})}">
    ë‹¤ìŒ &raquo;
  </a>
  <span th:if="${videoPage.last}" style="color: #ccc;">ë‹¤ìŒ &raquo;</span>
</div>




<script>
  document.addEventListener("DOMContentLoaded", function () {
    document.querySelectorAll(".video-thumbnail").forEach(video => {
      video.addEventListener("loadeddata", function () {
        try {
          video.currentTime = 0.1; // ì¸ë„¤ì¼ìš© 0.1ì´ˆ
          video.pause();
        } catch (e) {}
      });
    });
  });
</script>
<!-- âœ… 4. Ajax ì‚­ì œ -->
<!--<script>
  function deleteVideo(button) {
      const videoId = $(button).data("id");
      if (confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
          $.ajax({
              url: "/admin/video/" + videoId,
              type: "DELETE",
              success: function () {
                  alert("ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
                  location.reload(); // ìƒˆë¡œê³ ì¹¨ìœ¼ë¡œ ë™ê¸°í™”
              },
              error: function () {
                  alert("ì‚­ì œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ");
              }
          });
      }
  }
</script>-->
</body>
</html>
